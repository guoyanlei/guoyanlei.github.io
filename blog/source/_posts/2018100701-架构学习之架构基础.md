title: 架构学习之架构基础
date: 2018/10/07 15:30:00
tags:
- 架构
categories:
- 学架构

---

### 架构概念

> 软件架构指软件系统的顶层结构。

- 子系统：子系统也是由一群有关联的个体所组成的系统，多半会是更大系统中一部分
- 框架：关注的是“规范”（Framework），如Spring MVC框架
- 架构：关注的是“结构”（Architecture）
- 模块：逻辑的角度来拆分系统后，得到的单元就是“模块”，主要目的是职责分离
- 组件：从物理的角度来拆分系统后，得到的单元就是“组件”，主要目的是单元复用

一句话总结：架构是顶层设计；框架是面向编程或配置的半成品；组件是从技术维度上的复用；模块是从业务维度上职责的划分；系统是相互协同可运行的实体。

<!--more-->

### 架构设计的目的
 

> 架构设计的主要目的是为了解决软件系统复杂度带来的问题。

一句话总结：架构即(重要)决策，是在一个有约束的盒子里去求解或接近最合适的解。这个有约束的盒子是团队经验、成本、资源、进度、业务所处阶段等所编织、掺杂在一起的综合体(人，财，物，时间，事情等)。架构无优劣，但是存在恰当的架构用在合适的软件系统中，而这些就是决策的结果。


### 软件系统复杂度的来源

#### 1. 高性能

> 单台计算机内部为了高性能带来的复杂度（垂直维度）
> 
> 多台计算机集群为了高性能带来的复杂度（水平维度）

垂直维度方案比较适合业务阶段早期和成本可接受的阶段，该方案是提升性能最简单直接的方式，但是受成本与硬件能力天花板的限制。

水平维度方案所带来的好处要在业务发展的后期才能体现出来。起初，该方案会花费更多的硬件成本，另外一方面对技术团队也提出了更高的要求；但是，没有垂直方案的天花板问题。一旦达到一定的业务阶段，水平维度是技术发展的必由之路。

#### 2. 高可用

> 系统无中断地执行其功能的能力

- 计算高可用（任务分配器，分配器于业务服务器的交互，分配算法等）
- 存储高可用（CAP定理：存储高可用不可能同时满足“一致性、可用性、分区容错性”，最多满足其中两个）

实现高可用的本质：“冗余”（高性能增加机器目的在于“扩展”处理性能；高可用增加机器目的在于“冗余”处理单元）

高可用的解决方法不是解决，而是减少或者规避，而规避某个问题的时候，一般都会引发另一个问题，只是这个问题比之前的小，高可用的设计过程其实也是一个取舍的过程。

#### 3. 可扩展

> 系统为了应对将来需求变化而提供的一种扩展能力，当有新的需求出现时，系统不需要或者仅需要少量修改就可以支持，无须整个系统重构或者重建。

设计具备良好可扩展性的系统：
1）从业务维度。对业务深入理解，对可预计的业务变化进行预测。
2）从技术维度。利用扩展性好的技术，实现对变化的封装。

#### 4. 低成本

> 低成本本质上是与高性能和高可用冲突的，当无法设计出满足成本要求的方案，就只能协调并调整成本目标

一般通过创新达到低成本目标：

- 引入新技术
- 开创一个全新技术领域

#### 5. 安全

> 功能安全（防小偷）：减少系统潜在的缺陷，阻止黑客破坏行为
> 
> 架构安全（防强盗）：保护系统不受恶意访问和攻击，保护系统的重要数据不被窃取

#### 6. 规模

> 规模带来复杂度的主要原因就是“量变引起质变”，当数量超过一定的阈值后，复杂度会发生质的变化

规模问题需要与高性能、高可用、高扩展、高伸缩性统一考虑。常采用“分而治之，各个击破”的方法策略。

### 架构设计三原则

#### 合适原则

> 合适优于业界领先

#### 简单原则

> 简单优于复杂

#### 演化原则

> 演化优于一步到位


### 架构设计流程

#### 第一步：识别复杂度

> 将主要的复杂度问题列出来，然后根据业务、技术、团队等综合情况进行排序，优先解决当前面临的最主要的复杂度问题。

具体做法：

- 构建复杂度的来源清单——高性能、可用性、扩展性、安全、低成本、规模等。
- 结合需求、技术、团队、资源等对上述复杂度逐一分析是否需要？是否关键？
- 按照上述的分析结论，得到复杂度按照优先级的排序清单，越是排在前面的复杂度，就越关键，就越优先解决。


#### 第二步：设计备选方案

- 备选方案不要过于详细。备选阶段解决的是技术选型问题，而不是技术细节。
- 备选方案的数量以 3~5个为最佳。
- 备选方案的技术差异要明显。
- 备选方案不要只局限于已经熟悉的技术。

#### 第三步：评估和选择备选方案

> 列出我们需要关注的质量属性点，然后分别从这些质量属性的维度去评估每个方案，再综合挑选适合当时情况的最优方案。

质量属性：性能、可用性、硬件成本、项目投入、复杂度、安全性、可扩展性等

#### 第四步：详细方案设计

> 详细方案设计是将方案涉及的关键技术细节给确定下来


