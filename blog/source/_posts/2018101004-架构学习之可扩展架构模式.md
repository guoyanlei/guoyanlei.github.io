title: 架构学习之可扩展架构模式
date: 2018/10/10 15:30:00
tags:
- 架构
categories:
- 学架构

---

### 可扩展的基本思想

> 总结为一个字：拆！

流程 > 服务 > 功能

- 面向流程拆分：将整个业务流程拆分为几个阶段，每个阶段作为一部分（得到分层架构）
- 面向服务拆分：将系统提供的服务拆分，每个服务作为一部分（SOA、微服务）
- 面向功能拆分：将系统提供的功能拆分，每个功能作为一部分（微内核架构）

<!--more-->

### 分层架构

> 本质在于隔离关注点，即每个层中的组件只会处理本层的逻辑。

- C/S 架构、B/S 架构（划分的对象是整个业务系统，划分的维度是用户交互）
- MVC 架构、MVP 架构（划分的对象是单个业务子系统，划分的维度是职责）
- 逻辑分层架构（划分的对象可以是整个或单个业务子系统，划分的维度也是职责，逻辑分层架构中的层是自顶向下依赖的）

### SOA架构（面向服务架构）

> SOA 出现的背景是企业内部的系统重复建设且效率低下，SOA 解决了传统 IT 系统重复建设和扩展效率低的问题。

- SOA是集成的思想，是解决服务孤岛打通链条，是无奈之举。
- ESB集中化的管理带来了性能不佳，厚重等问题。也无法快速扩展。不适合互联网的业务特点

### 微服务架构

> SOA 和微服务本质上是两种不同的架构设计理念，只是在“服务”这个点上有交集而已。

- 微服务是 SOA 的实现方式（服务粒度比SOA细）
- 微服务是去掉 ESB 后的 SOA（更为轻量级，例如HTTP RESTful）
- 微服务是一种和 SOA 相似但本质上不同的架构理念（服务交付快，适合互联网）

#### 微服务拆分方法（维度）：

1. 基于业务逻辑拆分（系统中的业务模块按照职责范围识别出来，每个单独的业务模块拆分为一个独立的服务）
2. 基于可扩展拆分（将系统中的业务模块按照稳定性排序，将已经成熟和改动不大的服务拆分为稳定服务，将经常变化和迭代的服务拆分为变动服务）
3. 基于可靠性拆分（将系统中的业务模块按照优先级排序，将可靠性要求高的核心服务和可靠性要求低的非核心服务拆分开来，然后重点保证核心服务的高可用）
4. 基于性能拆分（将性能要求高或者性能压力大的模块拆分出来，避免性能压力大的服务影响其他服务）

#### 微服务基础设施：

- 自动化测试（通过自动化测试系统来完成绝大部分测试回归的工作）
- 自动化部署（自动化部署的系统来完成大量的部署操作）
- 配置中心（有的运行期配置需要动态修改并且所有节点即时生效，人工操作是无法做到的）
- 接口框架（HTTP/REST 或者 RPC 方式）
- API网关（内部的微服务之间是互联互通的，相互之间的访问都是点对点的，需要一个统一的 API 网关，负责外部系统的访问操作）
- 服务发现
 - 自理式：每个微服务自己完成服务发现
 - 代理式：由负载均衡系统来完成微服务之间的服务发现
- 服务路由（进行某次调用请求时，我们还需要从所有符合条件的可用微服务节点中挑选出一个具体的节点发起请求）
- 服务容错（从整体上来看，系统中某个微服务出故障的概率会大大增加）
- 服务监控（需要服务监控系统来完成微服务节点的监控）
- 服务跟踪（跟踪某一个请求在微服务中的完整路径）
- 服务安全（接入安全、数据安全、传输安全）

### 微内核架构（插件化架构）

两类组件：

- 核心系统（core system）：负责和具体业务功能无关的通用功能（模块加载、模块间通信等）
- 插件模块（plug-in modules）：负责实现具体的业务逻辑
